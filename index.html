<?php
session_start();
include 'koneksi.php'; // Pastikan ada koneksi ke database

// Ambil data pengguna dari database berdasarkan sesi
$stmt = $conn->prepare("SELECT nama, email, role FROM users WHERE id = ?");
$stmt->bind_param("i", $user_id); // "i" untuk tipe integer
$stmt->execute();
$result = $stmt->get_result();
$user = $result->fetch_assoc();
$stmt->close();
?>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Pelayanan PLN</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans leading-normal tracking-normal">
    <div class="flex min-h-screen">
        
        <!-- Sidebar -->
        <div class="w-64 bg-pink-500 p-6 text-white flex flex-col">
            <div class="text-center mb-6">
                <img src="profile.jpeg" alt="Profile" class="w-20 h-20 rounded-full mx-auto border-4 border-white">
                <h3 class="text-lg font-semibold mt-2">Ajeng</h3>
                <p class="text-sm">ADMIN</p>
                <p class="text-xs text-gray-300">ajeng@gmail.com</p>
            </div>
            <nav class="flex-1">
                <ul>
                    <li class="mb-3"><a href="dashboard.php" class="block px-4 py-2 hover:bg-pink-400 rounded">Dashboard</a></li>
                    <li class="mb-3"><a href="location.php" class="block px-4 py-2 hover:bg-pink-400 rounded">Location</a></li>
                    <li class="mb-3"><a href="settings.php" class="block px-4 py-2 hover:bg-pink-400 rounded">Settings</a></li>
                    <li class="mb-3"><a href="logout.php" class="block px-4 py-2 bg-red-500 hover:bg-red-600 rounded">Logout</a></li>
                </ul>
                <footer class="bg-gray-800 text-white py-6">
        <div class="container mx-auto px-6 text-center">
            <p>Â© <?= date('Y') ?> Dashboard Tim Support PLN. Dikembangkan untuk monitoring tim support.</p>
        </div>
    </footer>
            </nav>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-8">
            <h1 class="text-3xl font-semibold mb-6">IT Support Dashboard</h1>
            
            <!-- Card Statistik -->
            <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="bg-yellow-200 shadow-lg rounded-lg p-6 text-center">
                    <h2 class="text-3xl font-bold">947</h2>
                    <p class="text-gray-800">Total Tickets</p>
                </div>
                <div class="bg-green-200 shadow-lg rounded-lg p-6 text-center">
                    <h2 class="text-3xl font-bold">19</h2>
                    <p class="text-gray-800">STI</p>
                </div>
                <div class="bg-blue-200 shadow-lg rounded-lg p-6 text-center">
                    <h2 class="text-3xl font-bold">128</h2>
                    <p class="text-gray-800">Support</p>
                </div>
                <div class="bg-pink-200 shadow-lg rounded-lg p-6 text-center">
                    <h2 class="text-3xl font-bold">5</h2>
                    <p class="text-gray-800">Back Office</p>
                </div>
            </div>

            <!-- Recent Tickets Table -->
            <div class="bg-white shadow-lg rounded-lg overflow-hidden">
                <table class="w-full text-left border-collapse">
                    <thead class="bg-gray-100 border-b">
                        <tr>
                            <th class="p-4">No</th>
                            <th class="p-4">Type</th>
                            <th class="p-4">Ticket ID</th>
                            <th class="p-4">Location</th>
                            <th class="p-4">User</th>
                            <th class="p-4">Issue</th>
                            <th class="p-4">Status</th>
                            <th class="p-4">Open Time</th>
                            <th class="p-4">Update Time</th>
                            <th class="p-4">Close Time</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y">
                    <tr onclick="viewTicket('1331960')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">1</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331960</td>
            <td class="py-2 px-4 border-b">JAKARTA 1</td>
            <td class="py-2 px-4 border-b">adriansyah.hendar</td>
            <td class="py-2 px-4 border-b">Email Corporate</td>
            <td class="py-2 px-4 border-b"><span class="bg-red-200 text-red-600 px-2 py-1 rounded-full">Assigned</span></td>
            <td class="py-2 px-4 border-b">2:07:51</td>
            <td class="py-2 px-4 border-b">2:22:48</td>
            <td class="py-2 px-4 border-b">2:30:19</td>
        </tr>
        <tr onclick="viewTicket('1331961')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">2</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331961</td>
            <td class="py-2 px-4 border-b">JAKARTA 2</td>
            <td class="py-2 px-4 border-b">rachmat.suryadi</td>
            <td class="py-2 px-4 border-b">System Crash</td>
            <td class="py-2 px-4 border-b"><span class="bg-yellow-200 text-yellow-600 px-2 py-1 rounded-full">In Progress</span></td>
            <td class="py-2 px-4 border-b">3:10:12</td>
            <td class="py-2 px-4 border-b">3:25:34</td>
            <td class="py-2 px-4 border-b">3:45:10</td>
        </tr>
        <tr onclick="viewTicket('1331962')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">3</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331962</td>
            <td class="py-2 px-4 border-b">JAKARTA 3</td>
            <td class="py-2 px-4 border-b">andy.pratama</td>
            <td class="py-2 px-4 border-b">Login Issue</td>
            <td class="py-2 px-4 border-b"><span class="bg-green-200 text-green-600 px-2 py-1 rounded-full">Resolved</span></td>
            <td class="py-2 px-4 border-b">1:12:11</td>
            <td class="py-2 px-4 border-b">1:50:25</td>
            <td class="py-2 px-4 border-b">1:55:13</td>
        </tr>
        <tr onclick="viewTicket('1331963')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">4</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331963</td>
            <td class="py-2 px-4 border-b">JAKARTA 1</td>
            <td class="py-2 px-4 border-b">ivan.kurniawan</td>
            <td class="py-2 px-4 border-b">Network Outage</td>
            <td class="py-2 px-4 border-b"><span class="bg-red-200 text-red-600 px-2 py-1 rounded-full">Assigned</span></td>
            <td class="py-2 px-4 border-b">5:05:23</td>
            <td class="py-2 px-4 border-b">5:17:43</td>
            <td class="py-2 px-4 border-b">5:30:10</td>
        </tr>
        <tr onclick="viewTicket('1331964')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">5</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331964</td>
            <td class="py-2 px-4 border-b">JAKARTA 4</td>
            <td class="py-2 px-4 border-b">susan.puspitasari</td>
            <td class="py-2 px-4 border-b">Password Reset</td>
            <td class="py-2 px-4 border-b"><span class="bg-green-200 text-green-600 px-2 py-1 rounded-full">Resolved</span></td>
            <td class="py-2 px-4 border-b">6:11:45</td>
            <td class="py-2 px-4 border-b">6:35:22</td>
            <td class="py-2 px-4 border-b">6:50:03</td>
        </tr>
        <tr onclick="viewTicket('1331965')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">6</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331965</td>
            <td class="py-2 px-4 border-b">JAKARTA 5</td>
            <td class="py-2 px-4 border-b">leo.martin</td>
            <td class="py-2 px-4 border-b">Network Slowdown</td>
            <td class="py-2 px-4 border-b"><span class="bg-yellow-200 text-yellow-600 px-2 py-1 rounded-full">In Progress</span></td>
            <td class="py-2 px-4 border-b">7:00:02</td>
            <td class="py-2 px-4 border-b">7:30:15</td>
            <td class="py-2 px-4 border-b">7:50:40</td>
        </tr>
        <tr onclick="viewTicket('1331966')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">7</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331966</td>
            <td class="py-2 px-4 border-b">JAKARTA 6</td>
            <td class="py-2 px-4 border-b">rino.rahardjo</td>
            <td class="py-2 px-4 border-b">Printer Issue</td>
            <td class="py-2 px-4 border-b"><span class="bg-green-200 text-green-600 px-2 py-1 rounded-full">Resolved</span></td>
            <td class="py-2 px-4 border-b">8:05:11</td>
            <td class="py-2 px-4 border-b">8:30:25</td>
            <td class="py-2 px-4 border-b">8:55:38</td>
        </tr>
        <tr onclick="viewTicket('1331967')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">8</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331967</td>
            <td class="py-2 px-4 border-b">JAKARTA 7</td>
            <td class="py-2 px-4 border-b">mirza.dharmasena</td>
            <td class="py-2 px-4 border-b">File Corruption</td>
            <td class="py-2 px-4 border-b"><span class="bg-yellow-200 text-yellow-600 px-2 py-1 rounded-full">In Progress</span></td>
            <td class="py-2 px-4 border-b">9:00:34</td>
            <td class="py-2 px-4 border-b">9:30:40</td>
            <td class="py-2 px-4 border-b">9:55:45</td>
        </tr>
        <tr onclick="viewTicket('1331968')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">9</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331968</td>
            <td class="py-2 px-4 border-b">JAKARTA 8</td>
            <td class="py-2 px-4 border-b">felix.hermawan</td>
            <td class="py-2 px-4 border-b">Access Denied</td>
            <td class="py-2 px-4 border-b"><span class="bg-red-200 text-red-600 px-2 py-1 rounded-full">Assigned</span></td>
            <td class="py-2 px-4 border-b">10:02:56</td>
            <td class="py-2 px-4 border-b">10:30:13</td>
            <td class="py-2 px-4 border-b">10:55:59</td>
        </tr>
        <tr onclick="viewTicket('1331969')" class="hover:bg-gray-50 cursor-pointer">
            <td class="py-2 px-4 border-b">10</td>
            <td class="py-2 px-4 border-b">Incident</td>
            <td class="py-2 px-4 border-b">1331969</td>
            <td class="py-2 px-4 border-b">JAKARTA 9</td>
            <td class="py-2 px-4 border-b">satria.purnama</td>
            <td class="py-2 px-4 border-b">Server Down</td>
            <td class="py-2 px-4 border-b"><span class="bg-green-200 text-green-600 px-2 py-1 rounded-full">Resolved</span></td>
            <td class="py-2 px-4 border-b">11:11:12</td>
            <td class="py-2 px-4 border-b">11:30:43</td>
            <td class="py-2 px-4 border-b">11:55:08</td>
        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>
